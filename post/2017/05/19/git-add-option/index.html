
<!DOCTYPE html>
<html lang="ja">
<head>

  
  <meta charset="UTF-8">
  <title>
    git add .とgit add -Aとgit add -uの違い | Blogrammer&#39;s.Net
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">

  
  <link rel="canonical" href="http://blogrammers.net/post/2017/05/19/git-add-option/"/>

  
  <link rel="stylesheet" href="/css/sanitize.css">
  <link rel="stylesheet" href="/css/responsive.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-plateau-light.min.css">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/custom.css">

  
  <link href="http://blogrammers.net/index.xml" rel="alternate" type="application/rss+xml" title="Blogrammer&#39;s.Net" />
  <link href="http://blogrammers.net/index.xml" rel="feed" type="application/rss+xml" title="Blogrammer&#39;s.Net" />

  
  


</head>



<body>
<div class="container">

  
  <header role="banner">
    <div class="row gutters">
      <div id="site-title" class="col span_6">
        <h1><a href="http://blogrammers.net/">Blogrammer&#39;s.Net</a></h1>
        <h2>平凡なプログラマの平凡なプログラマによる誰かのためのブログ</h2>
      </div>
      <div id="social" class="col span_6">
        <ul>
          <li><a href="/about" >About</a></li>
          
          
          <li><a href="https://github.com/zth2" target="_blank">GitHub</a></li>
          
        </ul>
      </div>
    </div>
  </header>


  
  <main id="single" role="main">
    <div class="article-header">
      <h1>git add .とgit add -Aとgit add -uの違い</h1>
      <div class="meta">
        May 19, 2017 &nbsp;
        
          #<a href="/tags/git">git</a>&nbsp;
        
      </div>
    </div>
    <article>
      

<p>今までgit addするときはgit add .をずっと使ってきたのだが、-Aと-uとの違いがわからなかったので調べてみた。</p>

<h2 id="バージョン">バージョン</h2>

<p>Git for Windows2.13.0</p>

<h2 id="ヘルプで確認">ヘルプで確認</h2>

<p>とりあえずヘルプで-Aと-uを確認。</p>

<pre><code>$ git help add
</code></pre>

<blockquote>
<p>-A<br />
&ndash;all<br />
&ndash;no-ignore-removal<br />
Update the index not only where the working tree has a file matching &lt;pathspec&gt; but also where the index already has an entry.   This adds, modifies, and removes index entries to match the working tree.</p>

<p>If no &lt;pathspec&gt; is given when -A option is used, all files in the entire working tree are updated <span style="color:red;">(old versions of Git used to limit the update to the current directory and its subdirectories)</span>.</p>

<p>-u<br />
&ndash;update<br />
Update the index just where it already has an entry matching &lt;pathspec&gt;. This removes as well as modifies index entries to match the working tree, but adds no new files.</p>

<p>If no &lt;pathspec&gt; is given when -u option is used, all tracked files in the entire working tree are updated <span style="color:red;">(old versions of Git used to limit the update to the current directory and its subdirectories)</span>.</p>
</blockquote>

<p>英語は苦手なので翻訳しながら確認した。<br />
たぶん以下であってると思う。</p>

<ul>
<li>-Aは作業ツリーの追加、変更、削除ファイルすべて対象<br /></li>
<li>-uは追跡ファイル(git管理ファイル)の変更、削除ファイルが対象<br /></li>
</ul>

<p>ただし、赤字の箇所に書いてあるように<span style="color:red;">-A、-uともに古いGitではカレントディレクトリ配下のみ対象</span>だったようだ。</p>

<p>現段階の最新のGitで確認してみる。</p>

<h2 id="ファイル作って確認">ファイル作って確認</h2>

<p>以下のようなファイル構成のプロジェクトを用意する。</p>

<pre><code>b.txt  
c.txt  
dir1  (ディレクトリ)  
└─ d.txt
</code></pre>

<p>ここで追加(a.txt)、変更(b.txt)、削除(d/d.txt)を行う。</p>

<pre><code>$ echo a &gt; a.txt
$ echo b &gt;&gt; b.txt
$ rm dir1/d.txt  
$ git status -s
 M b.txt
 D dir1/d.txt
?? a.txt
</code></pre>

<ul>
<li><p>git add .の場合</p>

<pre><code>$ git add .
$ git status -s
A  a.txt
M  b.txt
D  dir1/d.txt
</code></pre></li>

<li><p>git add -Aの場合</p>

<pre><code>$ git add -A
$ git status -s
A  a.txt
M  b.txt
D  dir1/d.txt
</code></pre></li>

<li><p>git add -uの場合</p>

<pre><code>$ git add -u
$ git status -s
M  b.txt
D  dir1/d.txt
?? a.txt
</code></pre>

<h3 id="結果">結果</h3>

<ul>
<li>git add . 　-&gt; 追加、変更、削除ファイルすべてが追加される</li>
<li>git add -A -&gt; 追加、変更、削除ファイルすべてが追加される</li>
<li>git add -u -&gt; 変更、削除ファイルが追加され、追加ファイルは追加されない</li>
</ul></li>
</ul>

<h2 id="カレントディレクトリをサブディレクトリに変えてみる">カレントディレクトリをサブディレクトリに変えてみる</h2>

<pre><code> $ cd dir1
</code></pre>

<ul>
<li><p>git add .の場合</p>

<pre><code>$ git status -s
 M ../b.txt
D  d.txt
?? ../a.txt
</code></pre></li>

<li><p>git add -Aの場合</p>

<pre><code>$ git add -A
$ git status -s
A  ../a.txt
M  ../b.txt
D  d.txt
</code></pre>

<h3 id="結果-1">結果</h3>

<ul>
<li>git add . 　-&gt; カレントディレクトリのファイルのみ追加される</li>
<li>git add -A -&gt; すべてのファイルが追加される</li>
</ul></li>
</ul>

<h2 id="まとめ">まとめ</h2>

<p>git add .とgit add -Aではカレントディレクトリがルートディレクトリではなくサブディレクトリの場合に挙動が異なる。<br />
ただ、git bashでは基本的にルートディレクトリで作業するので（私の場合）すべてのファイルを追加するときはgit add .で問題なさそう。<br />
git管理外のファイルがありgit管理のファイルのみaddする場合はgit add -uを使えばよい。</p>

      
      
      
    </article>
    


  </main>
  
  <nav class="pagination-single">
    
      <span class="previous">&larr; <a href="http://blogrammers.net/post/2017/05/17/git-install/" rel="prev">Gitインストール</a></span>
    
    
      <span class="next"><a href="http://blogrammers.net/post/2017/05/20/github-change-username/" rel="next">GitHubのユーザー名を変える</a> &rarr;</span>
    
  </nav>


  
  <footer role="contentinfo">
    <div style="text-align:center;">
      <img src="/images/profile.png" width="64" height="64"><br>
      
      Written by <a href="/about" >Soutarou</a>
    </div>
  </footer>


</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</body>
</html>

